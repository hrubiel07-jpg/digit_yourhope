# Activation du module de réécriture
RewriteEngine On

# Définir le dossier de base
RewriteBase /digital_yourhope/

# Protection contre l'accès direct aux fichiers sensibles
<FilesMatch "\.(sql|log|ini|conf|env)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Protection des dossiers
Options -Indexes

# Redirection des pages d'erreur
ErrorDocument 404 /digital_yourhope/404.php
ErrorDocument 403 /digital_yourhope/403.php
ErrorDocument 500 /digital_yourhope/500.php

# Compression GZIP
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript
</IfModule>

# Mise en cache
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
</IfModule>

# Règles de réécriture SIMPLES et SÛRES

# Pages d'authentification
RewriteRule ^connexion/?$ auth/login.php [L]
RewriteRule ^inscription/?$ auth/register.php [L]
RewriteRule ^deconnexion/?$ auth/logout.php [L]

# Pages publiques (utiliser des URLs directes dans le code)
RewriteRule ^ecoles/?$ platform/schools.php [L]
RewriteRule ^enseignants/?$ platform/teachers.php [L]
RewriteRule ^recherche/?$ platform/search.php [L]

# Si le fichier existe, ne pas réécrire
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Pour éviter les erreurs 404, rediriger vers l'accueil
RewriteRule . index.php [L]